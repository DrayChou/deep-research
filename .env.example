# Deep Research 环境变量配置模板
# 复制此文件为 .env 并根据您的实际环境修改相应配置

# ================================
# 数据库配置 (Database Configuration) 
# ================================

# 数据库类型选择 (postgresql: 使用PostgreSQL, sqlite: 使用SQLite)
DATABASE_TYPE=postgresql

# PostgreSQL 基础连接配置
POSTGRES_HOST=pgvector
POSTGRES_PORT=5432
POSTGRES_DB=deep_research
POSTGRES_USER=pgvector
POSTGRES_PASSWORD=pgvector
POSTGRES_SSL=false

# 数据库URL配置 (根据客户环境自动选择)
DATABASE_URL_LOCAL=postgresql://pgvector:pgvector@localhost:45432/deep_research
DATABASE_URL_DEV=postgresql://pgvector:pgvector@pgvector:5432/deep_research
DATABASE_URL_PROD=postgresql://pgvector:pgvector@pgvector:5432/deep_research

# 强制使用PostgreSQL (即使配置检查失败)
FORCE_POSTGRESQL=true

# 数据库连接池配置
DB_POOL_SIZE=20

# SQLite数据库路径 (用于数据迁移，如果存在的话)
SQLITE_DB_PATH=./data/tasks.db

# ================================
# 系统基础配置
# ================================

# 访问控制密码 (可选，用于增强安全性)
ACCESS_PASSWORD=

# 运行时环境标识
NODE_ENV=production

# ================================
# AI 服务提供商 API 配置
# ================================

# Google Gemini API
GOOGLE_GENERATIVE_AI_API_KEY=
GOOGLE_GENERATIVE_AI_API_BASE_URL=https://generativelanguage.googleapis.com

# OpenAI API
OPENAI_API_KEY=
OPENAI_API_BASE_URL=https://api.openai.com

# Anthropic Claude API
ANTHROPIC_API_KEY=
ANTHROPIC_API_BASE_URL=https://api.anthropic.com

# DeepSeek API
DEEPSEEK_API_KEY=
DEEPSEEK_API_BASE_URL=https://api.deepseek.com

# XAI Grok API
XAI_API_KEY=
XAI_API_BASE_URL=https://api.x.ai

# Mistral API
MISTRAL_API_KEY=
MISTRAL_API_BASE_URL=https://api.mistral.ai

# Azure OpenAI API
AZURE_API_KEY=
AZURE_API_VERSION=
AZURE_RESOURCE_NAME=

# OpenRouter API
OPENROUTER_API_KEY=
OPENROUTER_API_BASE_URL=https://openrouter.ai

# Ollama (本地模型)
OLLAMA_API_BASE_URL=http://0.0.0.0:11434

# ================================
# 搜索服务 API 配置
# ================================

# Tavily Search API
TAVILY_API_KEY=
TAVILY_API_BASE_URL=https://api.tavily.com

# Firecrawl API
FIRECRAWL_API_KEY=
FIRECRAWL_API_BASE_URL=https://api.firecrawl.dev

# Exa Search API
EXA_API_KEY=
EXA_API_BASE_URL=https://api.exa.ai

# Bocha API
BOCHA_API_KEY=
BOCHA_API_BASE_URL=https://api.bochaai.com

# SearXNG (自建搜索引擎)
SEARXNG_API_BASE_URL=http://0.0.0.0:8080

# ================================
# MCP (Model Context Protocol) 配置
# ================================

# MCP 服务器AI提供商
# 可选值: google, openai, anthropic, deepseek, xai, mistral, azure, openrouter, ollama
MCP_AI_PROVIDER=

# MCP 服务器搜索提供商 (默认: model)
# 可选值: model, tavily, firecrawl, exa, bocha, searxng
MCP_SEARCH_PROVIDER=

# MCP 思考模型ID (用于深度研究的核心模型)
MCP_THINKING_MODEL=

# MCP 任务模型ID (用于二级任务，推荐高输出模型)
MCP_TASK_MODEL=

# ================================
# 通知系统配置
# ================================

# 通知系统总开关
NOTIFICATION_ENABLED=true

# 启用的通知渠道 (用逗号分隔)
# 可选值: wechat-work, feishu, telegram, bark, pushdeer, email, webhook
NOTIFICATION_CHANNELS=feishu,bark

# 全局重试次数和去重配置
NOTIFICATION_RETRY_ATTEMPTS=3
NOTIFICATION_DEDUP_ENABLED=true
NOTIFICATION_DEDUP_WINDOW=30

# 飞书群机器人 Webhook 地址
FEISHU_WEBHOOK=https://open.feishu.cn/open-apis/bot/v2/hook/YOUR_HOOK_ID_HERE
FEISHU_RETRY_ATTEMPTS=3

# Bark iOS 推送配置
BARK_SERVER=https://api.day.app
BARK_DEVICE_KEY=YOUR_DEVICE_KEY_HERE
BARK_RETRY_ATTEMPTS=3

# ================================
# 系统功能控制
# ================================

# 禁用的AI提供商 (用逗号分隔)
NEXT_PUBLIC_DISABLED_AI_PROVIDER=

# 禁用的搜索提供商 (用逗号分隔)
NEXT_PUBLIC_DISABLED_SEARCH_PROVIDER=

# 自定义模型列表 (添加或删除模型)
NEXT_PUBLIC_MODEL_LIST=

# 自定义脚本代码 (用于统计或错误追踪)
HEAD_SCRIPTS=

# ================================
# 配置说明
# ================================

# 1. 数据库配置说明：
#    - 首次启动时，系统会自动检测并初始化PostgreSQL数据库
#    - 如果检测到SQLite数据文件，会自动执行数据迁移
#    - 支持多环境客户端，根据请求来源自动识别环境

# 2. 最小配置要求：
#    - 至少配置一个AI提供商的API Key
#    - 至少配置一个搜索提供商的API Key (或使用model模式)
#    - PostgreSQL数据库连接信息

# 3. 推荐配置：
#    - OPENAI_API_KEY 或 DEEPSEEK_API_KEY (用于AI功能)
#    - TAVILY_API_KEY (用于搜索功能)
#    - PostgreSQL数据库配置 (用于数据持久化)
#    - 通知系统配置 (用于错误和状态通知)

# ================================
# 快速测试
# ================================

# 测试数据库连接：curl http://localhost:3001/api/init-status
# 测试系统健康：curl http://localhost:3001/api/test-db